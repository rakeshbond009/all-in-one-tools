<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Merger - Free Online Tool</title>
    <meta name="description" content="Merge multiple PDF files into a single document online for free. Easy to use, no registration required.">
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/style.css">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        .upload-area {
            border: 2px dashed #dee2e6;
            border-radius: 10px;
            padding: 2rem;
            text-align: center;
            background: #f8f9fa;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .upload-area:hover {
            border-color: var(--bs-primary);
            background: #fff;
        }
        
        .upload-icon {
            font-size: 3rem;
            color: var(--bs-primary);
            margin-bottom: 1rem;
        }
        
        .files-list {
            margin-top: 1rem;
            display: none;
        }
        
        .file-item {
            background: #fff;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
        }
        
        .file-item .drag-handle {
            cursor: move;
            color: #6c757d;
        }
        
        .progress {
            height: 0.5rem;
            margin-top: 1rem;
        }
        
        .features-list {
            margin-top: 3rem;
        }
        
        .feature-item {
            text-align: center;
            padding: 1.5rem;
        }
        
        .feature-icon {
            font-size: 2rem;
            color: var(--bs-primary);
            margin-bottom: 1rem;
        }
    </style>
</head>
<body>
    <!-- Header will be loaded dynamically -->
    <div id="header-container"></div>

    <main class="container py-4">
        <!-- Tool Section -->
        <div class="row mb-5">
            <div class="col-12 text-center">
                <h1 class="display-4 mb-3">PDF Merger</h1>
                <p class="lead mb-4">Combine multiple PDF files into a single document</p>
            </div>
        </div>

        <!-- Upload Section -->
        <div class="row justify-content-center mb-5">
            <div class="col-md-8">
                <div class="upload-area" id="uploadArea">
                    <i class="fas fa-cloud-upload-alt upload-icon"></i>
                    <h3>Drag & Drop PDF files here</h3>
                    <p class="text-muted">or</p>
                    <button class="btn btn-primary btn-lg" onclick="document.getElementById('fileInput').click()">
                        Choose Files
                    </button>
                    <input type="file" id="fileInput" accept=".pdf" multiple style="display: none;">
                    <p class="text-muted mt-2">You can select multiple files</p>
                </div>

                <!-- Files List -->
                <div class="files-list" id="filesList">
                    <h4 class="mb-3">Selected Files</h4>
                    <div id="filesContainer">
                        <!-- Files will be added here -->
                    </div>
                    <div class="progress mt-3">
                        <div class="progress-bar" role="progressbar" style="width: 0%"></div>
                    </div>
                    <button class="btn btn-primary w-100 mt-3" id="mergeBtn">
                        Merge PDFs
                    </button>
                </div>
            </div>
        </div>

        <!-- Features Section -->
        <div class="row features-list">
            <div class="col-md-4 feature-item">
                <i class="fas fa-object-group feature-icon"></i>
                <h4>Multiple Files</h4>
                <p>Merge any number of PDF files</p>
            </div>
            <div class="col-md-4 feature-item">
                <i class="fas fa-sort feature-icon"></i>
                <h4>Reorder Pages</h4>
                <p>Arrange files in any order</p>
            </div>
            <div class="col-md-4 feature-item">
                <i class="fas fa-check-circle feature-icon"></i>
                <h4>Preserve Quality</h4>
                <p>Maintain original PDF quality</p>
            </div>
        </div>

        <!-- How to Use Section -->
        <div class="row mt-5">
            <div class="col-12">
                <h2 class="text-center mb-4">How to Use</h2>
                <div class="row">
                    <div class="col-md-3 text-center">
                        <div class="p-3">
                            <i class="fas fa-upload fa-2x text-primary mb-3"></i>
                            <h5>1. Upload PDFs</h5>
                            <p>Select or drag & drop multiple PDF files</p>
                        </div>
                    </div>
                    <div class="col-md-3 text-center">
                        <div class="p-3">
                            <i class="fas fa-sort fa-2x text-primary mb-3"></i>
                            <h5>2. Arrange Order</h5>
                            <p>Drag and drop to reorder files</p>
                        </div>
                    </div>
                    <div class="col-md-3 text-center">
                        <div class="p-3">
                            <i class="fas fa-object-group fa-2x text-primary mb-3"></i>
                            <h5>3. Merge</h5>
                            <p>Click merge and wait for processing</p>
                        </div>
                    </div>
                    <div class="col-md-3 text-center">
                        <div class="p-3">
                            <i class="fas fa-download fa-2x text-primary mb-3"></i>
                            <h5>4. Download</h5>
                            <p>Download your merged PDF file</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer will be loaded dynamically -->
    <div id="footer-container"></div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <!-- PDF.js library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <!-- PDF-lib for PDF manipulation -->
    <script src="https://unpkg.com/pdf-lib@1.17.1/dist/pdf-lib.min.js"></script>
    <!-- Sortable.js for drag and drop reordering -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
    <!-- Custom JS -->
    <script src="../assets/js/main.js"></script>
    <script src="../assets/js/pdf-tools.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const pdfTools = new PDFTools();
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            const filesList = document.getElementById('filesList');
            const filesContainer = document.getElementById('filesContainer');
            const mergeBtn = document.getElementById('mergeBtn');
            const progressBar = document.querySelector('.progress-bar');
            let uploadedFiles = [];

            // Initialize Sortable
            new Sortable(filesContainer, {
                animation: 150,
                handle: '.drag-handle',
                onSort: function() {
                    // Update the order of files in uploadedFiles array
                    const newOrder = [];
                    filesContainer.querySelectorAll('.file-item').forEach(item => {
                        const index = item.dataset.fileIndex;
                        newOrder.push(uploadedFiles[index]);
                    });
                    uploadedFiles = newOrder;
                }
            });

            // Handle drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = 'var(--bs-primary)';
                uploadArea.style.background = '#fff';
            });

            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.style.borderColor = '#dee2e6';
                uploadArea.style.background = '#f8f9fa';
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                handleFiles(e.dataTransfer.files);
            });

            // Handle file selection
            fileInput.addEventListener('change', (e) => {
                handleFiles(e.target.files);
            });

            // Merge button click
            mergeBtn.addEventListener('click', async () => {
                if (uploadedFiles.length < 2) {
                    alert('Please select at least 2 PDF files to merge.');
                    return;
                }

                mergeBtn.disabled = true;
                progressBar.style.width = '50%';

                try {
                    const mergedPdf = await pdfTools.mergePDFs(uploadedFiles);
                    progressBar.style.width = '100%';
                    
                    // Download the merged file
                    pdfTools.downloadFile(mergedPdf, 'merged_document.pdf');
                    
                    // Reset the form
                    setTimeout(() => {
                        resetForm();
                        mergeBtn.disabled = false;
                    }, 1000);
                } catch (error) {
                    console.error('Error merging PDFs:', error);
                    alert('Error merging PDFs. Please try again.');
                    progressBar.style.width = '0%';
                    mergeBtn.disabled = false;
                }
            });

            function handleFiles(files) {
                if (files.length > 0) {
                    Array.from(files).forEach(file => {
                        if (file.type === 'application/pdf') {
                            uploadedFiles.push(file);
                            addFileToList(file, uploadedFiles.length - 1);
                        }
                    });
                    filesList.style.display = 'block';
                }
            }

            function addFileToList(file, index) {
                const fileItem = document.createElement('div');
                fileItem.className = 'file-item d-flex align-items-center';
                fileItem.dataset.fileIndex = index;
                fileItem.innerHTML = `
                    <i class="fas fa-grip-vertical drag-handle me-2"></i>
                    <i class="fas fa-file-pdf text-danger me-2"></i>
                    <span class="flex-grow-1">${file.name}</span>
                    <button class="btn btn-sm btn-danger" onclick="removeFile(${index}, this)">
                        <i class="fas fa-times"></i>
                    </button>
                `;
                filesContainer.appendChild(fileItem);
            }

            function removeFile(index, button) {
                uploadedFiles.splice(index, 1);
                button.closest('.file-item').remove();
                if (uploadedFiles.length === 0) {
                    resetForm();
                }
            }

            function resetForm() {
                fileInput.value = '';
                filesContainer.innerHTML = '';
                filesList.style.display = 'none';
                progressBar.style.width = '0%';
                uploadedFiles = [];
            }

            // Make removeFile function globally accessible
            window.removeFile = removeFile;
        });
    </script>
</body>
</html> 